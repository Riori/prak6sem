#include <stdio.h>
#include <string.h>

#include "types.h"
#include "stribog.h"

void print_hash(struct stribog_ctx_t *ctx)
{
	u8 i;

	for (i = 0; i < 32; i++)
		printf("%02x", ctx->h[i]);

	putchar('\n');
}

void processing(char *s, stribog_ctx_t *ctx)
{

}

int main(int argc, char *argv[])
{
	struct stribog_ctx_t ctx;

	u8 message[64] = {
		0xee, 0xe2, 0xe5, 0xf0, 0xee, 0xe3, 0xc8, 0x20,
		0xfa, 0xea, 0xfa, 0xeb, 0xef, 0x20, 0xff, 0xfb,
		0xf0, 0xe1, 0xe0, 0xf1, 0xf5, 0x20, 0xe0, 0xed,
		0x20, 0xe8, 0xec, 0xe0, 0xeb, 0xe5, 0xf0, 0xf2,
		0xf1, 0x20, 0xff, 0xf0, 0xee, 0xec, 0x20, 0xf1,
		0x25, 0xfa, 0xf2, 0xfe, 0xe5, 0xe2, 0x20, 0x2c,
		0xe8, 0xf6, 0xf4, 0xe0, 0xe2, 0x20, 0xe8, 0xe6,
		0xee, 0xe1, 0xe8, 0xf0, 0xf2, 0xd1, 0x20, 0x2c
	};

	cout << "Result:" << endl;

	init(&ctx, HASH256);
	stribog(&ctx, message1, sizeof(message1));

	printf("H^{256}: ");
	print_hash(&ctx);

	return 0;
}
